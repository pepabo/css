title: 第2回「コンポーネント」
date: 2015-09-29 13:00:00
tags:
---

100年後も崩れないCSS勉強会、第2回です！

{% asset_img 001.png %}

というわけで、きょうは人と地球に優しいスタイルシートの話をさせてください！

{% asset_img 002.png %}

突然ですが、こちらはなんのへんてつもない Amazon のページです。このページをよく見てみると、同じような見た目のものがあると思いませんか？

{% asset_img 003.png %}

例えば、ヘッダーのメニューのなかの、右に小さな矢印がついたリンクとか…

{% asset_img 004.png %}

例えば、サイドバーのカテゴリーの見出しと各項目が一覧になっているリンクとか…

{% asset_img 005.png %}

本の書影とカテゴリーの見出し・本のタイトルが一緒になったリンクもあります。

{% asset_img 006.png %}

さらには、ページのなかでオレンジ色の太字の見出しなんかも、文字の大きさは違うけど同じ見た目ですね。

{% asset_img 007.png %}

こんなふうに、ウェブページはたくさんの要素があるように見えて、案外おなじ見た目の要素を繰り返したり、組み合わせることで作られています。

{% asset_img 008.png %}

このような共通した要素のことを、ここではコンポーネントと呼びたいと思います。

{% asset_img 009.png %}

「共通している」ということを言い換えると、「ここだけではなく他の場所でも再利用できる」ということでもあります。

{% asset_img 010.png %}

さきほどの Amazon の見出しをコーディングするぞ！となったとき、例えばこんなふうにスタイルシートを書いたとします。でも、この3つをよく見ると、文字の色や太さの指定はどれも共通していて、違うのは文字の大きさだけですね。

{% asset_img 011.png %}

じゃあ、ということで共通しているスタイルは .title という class のスタイルシートで前もって書いておいて、それぞれ .title に class を追加して項目ごとに文字の大きさを指定するようにしたら、どうでしょうか。こう書くと、文字の色や太さを変えたくなったときも、1行変えるだけで一気に変更できるので楽ちんです！

{% asset_img 012.png %}

この楽をしたいという怠惰な考えをもっと進めると、page だとか section だとかっていうのは場所の意味を指しているけど、どうせスタイルシートでは文字の大きさしか指定していないので、思い切って large だとか medium みたいな大きさの言葉で指定できるようにすると、どうでしょうか。こう書くと、ページの下のほうで 16px の見出しをつけたい！って思ったとき、その要素がどんな意味を持つ場所にあったって、HTML で .medium と class を追加するだけでスタイルを指定できて便利じゃないですか？

{% asset_img 013.png %}

しかし、この名前のつけかたには問題があります。というのも、スタイルシートはすべての指定が全体に適用されて、範囲を指定できないからです。ここでは large という名前をつけていますが、他の場所でも大きい要素を表現したい場合に large という名前をつけることも当然あると思います。そこでおもむろにその要素だけのサイズや背景色を指定されてしまったら… .large は .title.large にも影響するので、ぜんぜん想定していない見た目になってしまいます。ま、.large とかいう名前をつけないように気をつければいいって話なんですけど、現実的に意図しない見た目になっちゃたよオイというのは CSS を書いていて「あるある」なできごとですよね…。

{% asset_img 014.png %}

じゃあどうすればいいのか？ CSS の仕様が足りないのであれば自分たちで工夫しようということで、このように large は title に関するスタイルを指定しているんだよという気持ちを込めて、.title-large といった名前にするといいんじゃないかなというのが CSS 業界ではベストプラクティスになっています。こう書いておけば、おもむろに誰かが large って書いても影響を受けないので安心ですね。

{% asset_img 015.png %}

そんな感情をさっきの Amazon の見出しで実践しようと思うと、こんな感じでしょうか。それぞれ title の見た目を指定しているスタイルシートであるということと、title の文字の大きさを指定しているスタイルシートであることが名前からビンビンに伝わってくるのではないでしょうか。

{% asset_img 016.png %}

このとき CSS 業界の BEM（ベム）（ロシア発祥）という考え方をする人たちは、概念をわかりやすくするために、ここでいう title のことを「Block」と呼んでいて、

{% asset_img 017.png %}

large とか medium といったバリエーション違いを表している名前を「Modifier」と呼んでいます。

{% asset_img 018.png %}

いったん Amazon から離れて、こちらはなんのへんてつもない検索フォームですが、form 要素の .search-form のなかに、テキストフィールドの .search-form-textfield と、検索ボタンの .search-form-button が入っています。

{% asset_img 019.png %}

例によって CSS 業界の BEM（ベム）（ロシア発祥）という考え方をする人たちによると、ここでいう search-form を「Block」と呼んでいて、

{% asset_img 020.png %}

こんなふうに search-form の中に入っている textfield や button といった要素を「Element」と呼んでいます。

{% asset_img 021.png %}

でも、こんなふうに3種類の名前が混ざっていると、いったいこの名前は Block なのか Element なのか Modifier のどれを指しているのかわからないですよね…？

{% asset_img 022.png %}

そこで、BEM の概念を理解して噛み砕いた人たちが、MindBEMding（マインドベムディング？）という命名規則を考えました。Element の前にはアンダーバー2つ、Modifier の前にはハイフン2つをつけることにしようじゃないかと。これで Element と Modifier の区別がつく！やったー！

{% asset_img 023.png %}

さきほどの検索フォームを MindBEMding の命名規則を用いて書いてみたら、このようになるでしょうか。結果的にまぁ名前がめっちゃ長くなっちゃうわけですが、でも、textfiled や button が search-form のためにある要素だって、わかりやすくなったような気もします。

{% asset_img 024.png %}

巨大な検索フォームを作る必要があっても大丈夫。large という Modifier がついたときのスタイルを指定すればいいんです。意味と見た目を分離して、どこでも再利用できる部品として定義する。これで、search-form はコンポーネント化できたんじゃないでしょうか。

{% asset_img 025.png %}

こんなふうに再利用性できるコンポーネントを意識した CSS を書く命名規則や考え方は、BEM が考え出される前からオブジェクト指向 CSS と呼ばれていたり、BEM の影響を受けて派生したフレームワークのようなものもあります。でも、どれもコンポーネントを意識するという視点は同じです。MindBEMding のハイフン2つやアンダーバー2つといった命名規則だって別に強制されているわけではなく、壊れにくい CSS を書くためのヒントとして、どう書いたっていいし、なによりチームメンバーや半年後のすべてを忘れた自分に伝わればいいんじゃないかなと思います。

{% asset_img 026.png %}

さて、こちらはなんのへんてつもないタブのメニューです。クリックするとページに移動して、選択したタブの色がオレンジ色に変わるよくあるやつです。このスタイルがページのなかで何度も登場するので、業を煮やしてきょうはこれをコンポーネントにしようと思います。いったいどうやって書いたらいいでしょうか？

{% asset_img 027.png %}

1案としては、.global-menu を Block の名前として、そのなかにあるやつを .global-menu からはじまる名前にして .global-menu-item にする。そうすれば、.global-menu 関連の要素なんだなっていうのが伝わりますね。そして、選択中のタブには active って class をつけることで区別する。

{% asset_img 028.png %}

いやいや、.active は他のところで .active っておもむろに書かれたら影響を受けちゃうので、あと Modifier ってことも伝えたいし、先頭に .is- をつけちゃおう、とか。

{% asset_img 029.png %}

いや、そもそも .global-menu っていうけど、グローバルメニュー以外でもこの見た目あるよねってことで、どこでも使えるように意味ではなく見た目をあらわす .tab-menu って名前にしちゃうとか。ハイフンの区切り文字と Element の区別がつかないから、BEM の書き方をとりいれてみるとか。

{% asset_img 030.png %}

俺はアンダーバー派だよっていうか、アプリケーションの他のコードはアンダーバーならアンダーバーにしちゃってもいいし、Modifier はアンダーバー2個からはじめるルールにしちゃうぞっていうのも良いと思います。

{% asset_img 031.png %}

いやいや、tab-menu がコンポーネントなのかどうかっていうのはよくわからないから、もっとわかりやすくするために先頭に .c- をつけるよ、みたいな過激派？もいます。

{% asset_img 032.png %}

こんなふうにコンポーネントの名前を考えることや、すでに考案されている命名規則はこの緑色の本に詳しく書いてあるので、興味があったらぜひ読んでみてください！

{% asset_img 033.png %}

いま担当してるリリース済みのもう動いてるサービスでどうやって導入していけばいいの？っていうことについては、このペパボの GitHub Pages にある「CSS 設計の長い夢」っていうページで @otthi　さんが書かれているので、読んでください！

{% asset_img 034.png %}

まとめです。ページのなかでもし3回も同じ見た目の要素が登場することがあったら、ぜひこれはコンポーネントになるかもしれないって思って書いてみるのはどうでしょうか。きっと、あとで楽になったり便利になったり、壊れなかったりしてカッコいいと思います。ただし、逆になんでもコンポーネント化するとわけがわからなくなってしまうので、3回っていうのは結構よい基準なんじゃないかなっていうのは、やっぱりこの緑の本に書いてありましたので、僕も同意です。

{% asset_img 035.png %}

とはいえ、コンポーネントって自分で思ってるだけでは他の人はなんのことかよくわからないですよね。だから、チームメンバーや半年後の自分が把握できるように、スタイルシートの説明書を作るのはどうでしょうか。そんなドキュメントの作り方を、次回はお話ししたいです。よろしくお願いします！
